[toc]

PS. 本文基于单步预测结果进行激活函数的对比，代码版本及相关参数详见：[5af1d3acb2975eed96e2f6712f726032bcad1be7](https://github.com/liyinwei/copper_price_forecast/commit/5af1d3acb2975eed96e2f6712f726032bcad1be7)

# 1 Activation

Keras支持常见的激活函数，如：
- softmax
- elu
- softplus
- softsign
- relu
- tanh
- sigmoid
- hard_sigmoid
- linear
- PReLU
- LeakyReLU


## 1.1 matrics
|                          | tanh       | relu       | sigmoid    | softmax    | linear     | PReLU       | LeakyReLU  |
| ------------------------ | ---------- | ---------- | ---------- | ---------- | ---------- | ----------- | ---------- |
| training duration        | 682.614014 | 700.573279 | 695.635899 | 767.475581 | 795.208871 | 680.413787  | 693.162177 |
| explained_variance_score | 0.91652134 | 0.92040841 | 0.89996370 | 0.0        | 0.94075151 | 0.91499680  | 0.94916472 |
| mean_absolute_error      | 0.01376561 | 0.03416468 | 0.02033666 | 0.58987862 | 0.04408592 | 0.03875551  | 0.01451238 |
| mean_squared_error       | 0.00032603 | 0.00149843 | 0.00068069 | 0.35349551 | 0.00227103 | 0.00188387  | 0.00036661 |
| median_absolute_error    | 0.01103693 | 0.03496074 | 0.01671040 | 0.59029527 | 0.04495976 | 0.03732605  | 0.01139098 |
| r2_score                 | 0.93361122 | 0.76810895 | 0.86757909 | 0.0        | 0.63185289 | 0.58651780  | 0.93245702 |
| sum relative error       | -11.988655 | 83.389749  | -31.822903 | 1633.38100 | 117.177281 | -100.305342 | -24.631856 |
| mean relative error      | -0.011162  | 0.077644   | -0.029630  | 1.520838   | 0.10910361 | -0.09339417 | -0.022934  |


## 1.2 loss tracking

### 1.2.1 tanh
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_tanh_loss.png)

### 1.2.2 relu
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_relu_loss.png)

### 1.2.3 sigmoid
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_sigmoid_loss.png)

### 1.2.4 softmax
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_softmax_loss.png)

### 1.2.5 linear
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_linear_loss.png)

### 1.2.6 PReLU
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_PReLU_loss.png)

### 1.2.7 LeakyReLU
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_LeakyReLU_loss.png)



## 1.3 prediction

### 1.3.1 tanh
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_tanh_predict.png)


### 1.3.2 relu
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_relu_predict.png)

### 1.3.3 sigmoid
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_sigmoid_predict.png)

### 1.3.4 softmax
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_softmax_predict.png)

### 1.3.5 linear
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_linear_predict.png)

### 1.3.6 PReLU
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_PReLU_predict.png)

### 1.3.7 LeakyReLU
![image](https://github.com/liyinwei/res/raw/master/2017/copper_model_optimize_activation_LeakyReLU_predict.png)





## 1.4 loss and val_loss
### 1.4.1 tanh
- loss
  - [0.050733457485714888, 0.0060355264118295638, 0.0062966667532034027, 0.0057427426494637045, 0.0053566049993031195, 0.0042151628426977039, 0.004898022125137319, 0.0043916349386972668, 0.0036075814339509471, 0.0043360237883196158, 0.0034476320650742758, 0.0034544633910052946, 0.0036773874001942344, 0.0029790886940090676, 0.0030370221439235769, 0.0028612567847219298, 0.0027569245569750095, 0.003212743881311278, 0.0025331484168705084, 0.0023831177972896056, 0.0023467173771941447, 0.0027435685906405608, 0.0026419464822364544, 0.0024079947863097084, 0.0024951305102920047, 0.0023457064304671896, 0.0022395462480276794, 0.0021659628161462244, 0.002374540098821491, 0.0023289086609631915, 0.0021935165006555651, 0.0021652965672225139, 0.0020423385323590014, 0.0020929371425096426, 0.0020968091282242913, 0.0020521540791992076, 0.0017269781850463421, 0.0021127066856482342, 0.0022366450520820615, 0.0016437962655835169, 0.0020019416784607539, 0.0016534930956353553, 0.0018009479060959361, 0.002262709622276596, 0.0016961582183956598, 0.0016448983686715155, 0.001772632969686484, 0.0018106057565448056, 0.0018597572412160281, 0.0015646803468612443]

- val_loss
  - [0.012528891675174236, 0.0012159921461716294, 0.011588552035391331, 0.0024161094333976507, 0.0093275029212236404, 0.0014143467415124178, 0.0050254035741090775, 0.0011085985461249948, 0.0062154065817594528, 0.00057647639187052846, 0.0055819256231188774, 0.0013880800688639283, 0.0040215905755758286, 0.0016676224768161774, 0.0058305719867348671, 0.0022619334049522877, 0.0034080797340720892, 0.00064440933056175709, 0.0050632390193641186, 0.0022235687356442213, 0.0068331453949213028, 0.00068407057551667094, 0.0043187304399907589, 0.0018524765037000179, 0.0028160251677036285, 0.0008704917854629457, 0.003692894009873271, 0.0015003990847617388, 0.0033987725619226694, 0.00087514100596308708, 0.0019668224267661572, 0.00043147531687282026, 0.0027811597101390362, 0.0010960330255329609, 0.0032846387475728989, 0.00030617538141086698, 0.0051044030115008354, 0.00028287892928346992, 0.0029842259828001261, 0.0010600524256005883, 0.0034492795821279287, 0.0014436277560889721, 0.0014906830620020628, 0.00024326136917807162, 0.0029426584951579571, 0.0008606620249338448, 0.0021792773623019457, 0.00040224232361651957, 0.0014577382244169712, 0.0011469977907836437]

### 1.4.2 relu
- loss
  - [0.062070780410147651, 0.0079943488667096729, 0.007437293746376859, 0.0080658923350134908, 0.0065706644277939369, 0.0072067214364592673, 0.0067098157296189382, 0.0060284130734364451, 0.0059104321830868445, 0.0056529998872690982, 0.0051534312042724531, 0.0055288227269340452, 0.005642694416748327, 0.00453241569541688, 0.0048878913201503421, 0.004223491217515099, 0.004225316446539863, 0.0049463916729678313, 0.0045695731758062345, 0.0041716827451484494, 0.0035431614573765632, 0.0043100629513777768, 0.0035571177704338307, 0.0042117757438188868, 0.0035220063295854287, 0.003587108489253402, 0.0042087469525345462, 0.0032543591598979257, 0.0039647970538003322, 0.0033622592250749316, 0.003370564305044592, 0.0038352790825425071, 0.002658438348388535, 0.0033327097305809799, 0.0037879233914946799, 0.0028172795162837334, 0.0030542097382610552, 0.0033867041477383636, 0.0030469541245244005, 0.002438601836537717, 0.0035423682105745822, 0.0029266379435826878, 0.0028052583237326133, 0.0034852176014379351, 0.0026968214879093486, 0.0030679408519335909, 0.0025649621123456741, 0.0029107160028768483, 0.0030623780474662013, 0.0031027694708679041]

- val_loss
  - [0.0009999364847317338, 0.010047194547951221, 0.0057201622985303402, 0.011875560507178307, 0.0065743844024837017, 0.0068051782436668873, 0.0010501102078706026, 0.0065728402696549892, 0.00074559333734214306, 0.0086338967084884644, 0.0016046679811552167, 0.0053559690713882446, 0.00096325617050752044, 0.0050781751051545143, 0.0019224218558520079, 0.0075714066624641418, 0.0010938644409179688, 0.0028644215781241655, 0.0012180333724245429, 0.0045874924398958683, 0.0016397420549765229, 0.0036026686429977417, 0.0011887018335983157, 0.0037798627745360136, 0.0015318180667236447, 0.0029210846405476332, 0.0019260977860540152, 0.0021309251897037029, 0.0011527505703270435, 0.0033491717185825109, 0.00077537074685096741, 0.0031258345115929842, 0.0014954174403101206, 0.0032198638655245304, 0.00063066143775358796, 0.0040267915464937687, 0.001072796294465661, 0.002639836398884654, 0.003362937830388546, 0.0025584676768630743, 0.000750694889575243, 0.003501382889226079, 0.0011915729846805334, 0.0051778745837509632, 0.00040115346200764179, 0.0022749542258679867, 0.00079535396071150899, 0.0020261814352124929, 0.00042332205339334905, 0.0014367554103955626]


### 1.4.3 sigmoid
- loss
  - [0.02274336436158526, 0.0028145527290381078, 0.0036407407467456878, 0.0032660352780144127, 0.0033992975094855782, 0.0030154597193994249, 0.0027103929373679201, 0.0027410722858749936, 0.0022705070516871395, 0.002572564643632268, 0.0022782408782903319, 0.0017135794310077271, 0.002052411301525863, 0.0021751986881115778, 0.0014639441021032905, 0.0022167596029250376, 0.0014224527469175435, 0.0017531009795948961, 0.0015139067832480038, 0.0014070859787708118, 0.0017245597475655237, 0.0012485675448062983, 0.0012454529709227194, 0.0015580101612293717, 0.0013270932755973313, 0.001088889737525342, 0.0013373310073482216, 0.0012171772962624615, 0.0010431521683896437, 0.0012147953207805341, 0.0012187877378182969, 0.00090713005777205767, 0.001310410408234187, 0.00093634891753183592, 0.0011670406649326478, 0.00083174366574217723, 0.001266583341473649, 0.00099678029673481256, 0.001059408839314132, 0.00091183736820852745, 0.001107037827822501, 0.00091346451121704494, 0.00095503383444625655, 0.0011444220719479317, 0.00073863846873305911, 0.0009491714510775146, 0.00089108173437800605, 0.0010551782569851492, 0.00081758824058816241, 0.0009609643323434257]

- val_loss
  - [0.0017959501128643751, 0.0018816920928657055, 0.0015444549499079585, 0.0018367957090958953, 0.0041330456733703613, 0.001238696975633502, 0.00084645941387861967, 0.0025122442748397589, 0.00075410411227494478, 0.0010230452753603458, 0.0019325427711009979, 0.0010072786826640368, 0.0018124917987734079, 0.00055567576782777905, 0.00099633168429136276, 0.00070569274248555303, 0.0039167371578514576, 0.00047861249186098576, 0.0026242239400744438, 0.00058054568944498897, 0.0012064530747011304, 0.00081283273175358772, 0.0015964360209181905, 0.00040049641393125057, 0.0017019411316141486, 0.00048733365838415921, 0.0015971207758411765, 0.00082603847840800881, 0.0016702665016055107, 0.00033521332079544663, 0.0017670448869466782, 0.00034877331927418709, 0.0014971725177019835, 0.00039550301153212786, 0.001360206981189549, 0.00029208839987404644, 0.00060213799588382244, 0.00026414750027470291, 0.00098402251023799181, 0.0004571678873617202, 0.00047361757606267929, 0.00036489337799139321, 0.00038065804983489215, 0.00025901210028678179, 0.0015830093761906028, 0.00034266227157786489, 0.00057976489188149571, 0.00032967361039482057, 0.00064241787185892463, 0.00059415708528831601]


### 1.4.4 softmax
- loss
  - [0.35031420799651319, 0.35031421238167215, 0.35031420659996576, 0.35031420241032346, 0.35031419224345806, 0.35031421604062646, 0.35031419355621268, 0.35031418246762597, 0.3503141891151918, 0.35031419894688581, 0.35031419358414362, 0.35031420282928766, 0.35031418257934976, 0.35031420081825937, 0.35031417769143375, 0.35031418584727081, 0.35031420363928517, 0.35031418928277752, 0.35031419461758873, 0.35031418436693051, 0.35031418769071343, 0.3503141785293622, 0.35031420830375365, 0.35031418766278244, 0.35031418718795632, 0.35031419646103135, 0.35031419428241733, 0.35031418447865431, 0.35031419852792156, 0.35031420076239744, 0.35031419012070597, 0.3503141995892976, 0.35031418274693549, 0.35031418799795383, 0.35031420207515207, 0.35031420682341335, 0.35031419260656038, 0.35031418587520174, 0.3503141784176384, 0.35031420799651319, 0.35031418467417091, 0.35031418327762348, 0.35031418593106362, 0.3503141998127452, 0.35031420715858475, 0.35031418294245209, 0.35031419827654303, 0.3503141866014064, 0.3503141969917194, 0.35031419626551469]

- val_loss
  - [0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545, 0.2296731024980545]


### 1.4.5 linear
- loss
  - [0.056620937339165497, 0.0060526921851132781, 0.010639702556471514, 0.0076659120551215336, 0.0075143428166739943, 0.0070817362174091488, 0.0063987787085870718, 0.0064445491273553155, 0.0056210700112666444, 0.005460062608883944, 0.0054727738296339026, 0.0054930687040586337, 0.0049066920350144261, 0.0051406176464899242, 0.0048399908431467882, 0.0047601134190728648, 0.0043574494570266763, 0.0043171949341156519, 0.0042744388840062634, 0.0042604456634732918, 0.0037172000570224479, 0.0042042311046607689, 0.0039864632134319691, 0.0038102175926941514, 0.0038937987419737342, 0.0034731454901124901, 0.0036182365294689036, 0.0043877234257803047, 0.0026241435890628031, 0.0039404478919584981, 0.0031628224823271266, 0.0038037920120192279, 0.0028987783072786902, 0.0040810506818370913, 0.0024113581777046649, 0.0035198325009347963, 0.0032185477253936418, 0.0034626935632251755, 0.0025799312975105762, 0.0032112647872243596, 0.0032617711615264278, 0.0026469658810388728, 0.0033052459350658794, 0.0025553088456273581, 0.0027967910867118064, 0.0031148452842442256, 0.003622748025242613, 0.0016723020913711319, 0.0034051256182524108, 0.0026800993824728538]

- val_loss
  - [0.0032097557559609413, 0.011035573668777943, 0.0048215710557997227, 0.0058087287470698357, 0.0052991025149822235, 0.0043943268246948719, 0.0070300665684044361, 0.0011407616548240185, 0.0082419533282518387, 0.0024826733861118555, 0.0059933695010840893, 0.001062832772731781, 0.0046119601465761662, 0.0018095221603289247, 0.0041307792998850346, 0.00089667172869667411, 0.0035930001176893711, 0.0016771154478192329, 0.0039696511812508106, 0.0026071290485560894, 0.0030034177470952272, 0.0013720126589760184, 0.0020320117473602295, 0.0013236632803454995, 0.0031207087449729443, 0.0033350810408592224, 0.0014447665307670832, 0.0020449208095669746, 0.0035356904845684767, 0.0016373241087421775, 0.0028113625012338161, 0.0013067021500319242, 0.0017917674267664552, 0.0018914780812337995, 0.0023359181359410286, 0.00064613885479047894, 0.0020641977898776531, 0.0019646431319415569, 0.0016499856719747186, 0.0012208933476358652, 0.002770586870610714, 0.00038927575224079192, 0.0018578750314190984, 0.0011417806381359696, 0.0030064238235354424, 0.00040501696639694273, 0.001062861061654985, 0.0010479156626388431, 0.00026892017922364175, 0.0024679882917553186]



### 1.4.6 PReLU
- loss
  - [0.052663668474721904, 0.010754401531967753, 0.0076356578963933533, 0.0081490726732136552, 0.0067476040606003779, 0.0056340652928210189, 0.006224013987628371, 0.0058718761741231706, 0.0049847518813978765, 0.0053697484698157051, 0.0044978543334390055, 0.0052937638826734594, 0.0050305873856049694, 0.0042242768313124736, 0.0048277610714347451, 0.0047484750939304427, 0.0037407668306550751, 0.0041856238463127181, 0.0041405345937769577, 0.003864499411241072, 0.0038622335431313503, 0.0042193869834516156, 0.0036216043767230382, 0.0032685042056495076, 0.0039836874060619068, 0.0038490984599771991, 0.0033291100396494527, 0.0032858742346887626, 0.0036592996033779656, 0.0031505872317849053, 0.0033622949856360494, 0.0035384433089136629, 0.0029128659874438235, 0.002935165348449668, 0.0029975402150599893, 0.0035352676011658609, 0.0028519531338359557, 0.002975854022064418, 0.0031469015630648141, 0.0030305676530800489, 0.002727431669785888, 0.0026905741051604032, 0.0028717664584095022, 0.0031271203332244582, 0.0027176541986114991, 0.0025828212747069281, 0.0027499165258962999, 0.0026460371485142334, 0.0028727103803514553, 0.002140355427904821]

- val_loss
  - [0.0090054487809538841, 0.0023028966970741749, 0.0043341610580682755, 0.002888320479542017, 0.0079102693125605583, 0.0047679846175014973, 0.0016596009954810143, 0.0013491899007931352, 0.0035181273706257343, 0.0013576425844803452, 0.0083961337804794312, 0.0017290534451603889, 0.003685919102281332, 0.002455761656165123, 0.0013105395482853055, 0.0026421276852488518, 0.0052615026943385601, 0.00089570583077147603, 0.0037345271557569504, 0.0036579864099621773, 0.0034894559066742659, 0.00079578848090022802, 0.0064898598939180374, 0.0012406152673065662, 0.0027112120296806097, 0.00074924627551808953, 0.0040384209714829922, 0.00044506057747639716, 0.0018172299023717642, 0.0010478708427399397, 0.0025940851774066687, 0.0010100327199324965, 0.0042797047644853592, 0.0029712901450693607, 0.0043292287737131119, 0.00023294304264709353, 0.0022917950991541147, 0.0011309542460367084, 0.0017640998121351004, 0.00060294003924354911, 0.0036234988365322351, 0.00076537131099030375, 0.0018718510400503874, 0.00046039652079343796, 0.0026484692934900522, 0.00026464118855074048, 0.003987249918282032, 0.00019095536845270544, 0.00076629722025245428, 0.0027243474032729864]



### 1.4.7 LeakyReLU
- loss
  - [0.052487210897796885, 0.010465707622936315, 0.0077173210158525164, 0.0077842168384270908, 0.0074624097849318328, 0.0062426370210708192, 0.0061195405198378105, 0.0064108033019494208, 0.0051086876692377804, 0.0052343000716336885, 0.0048908240110774881, 0.0051130986174144329, 0.0043495385388249309, 0.0051295531740378946, 0.0040649599439334452, 0.0037143177655285472, 0.0050130324233532818, 0.0038438618013804608, 0.004039418012307016, 0.0045735977815713775, 0.0038015549666847903, 0.0030682879723102244, 0.0042362834644201017, 0.0036029539115974836, 0.0031972465087025102, 0.0037250846503049332, 0.0034760316522249074, 0.0034529157098550298, 0.003463594188814199, 0.0035333467565386118, 0.0030580737700925016, 0.0034856158099202711, 0.0025735851473261402, 0.003475689042478297, 0.0033015060791049254, 0.0028716841694700766, 0.0030887070137679213, 0.003128732494606646, 0.0029897431757007816, 0.0030329544917656755, 0.0026863792371319044, 0.0032738200790356172, 0.002266862836313777, 0.0030072747868064168, 0.0030373212501263523, 0.0024353029521054746, 0.0029241164160792865, 0.002741263559303703, 0.0023783432408572011, 0.0027297968914446044]

- val_loss
  - [0.0082244817167520523, 0.0033874532673507929, 0.0073236231692135334, 0.0034171512816101313, 0.0049538584426045418, 0.0027493750676512718, 0.0044431313872337341, 0.0028633989859372377, 0.0054329237900674343, 0.0027618419844657183, 0.0052184979431331158, 0.002015615114942193, 0.0052361288107931614, 0.0010613836348056793, 0.0049113482236862183, 0.002210286445915699, 0.004175238311290741, 0.0026736683212220669, 0.0033657276071608067, 0.00037455622805282474, 0.0046342713758349419, 0.0012894822284579277, 0.0018809657776728272, 0.0014457012293860316, 0.0022455393336713314, 0.00052408990450203419, 0.0023291232064366341, 0.00057987961918115616, 0.0022352321539074183, 0.00078807608224451542, 0.0035493143368512392, 0.0015872523654252291, 0.0042777382768690586, 0.0010365163907408714, 0.0015894216485321522, 0.0013046093517914414, 0.0020549437031149864, 0.00040937605081126094, 0.0028658823575824499, 0.0010776690905913711, 0.0030458297114819288, 0.00042169351945631206, 0.0046715498901903629, 0.00098123482894152403, 0.0019565129186958075, 0.0015114083653315902, 0.00061191071290522814, 0.0019223892595618963, 0.0012304597767069936, 0.00031998555641621351]


